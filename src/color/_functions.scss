// ============================================================================================= //
//                                           FUNCTIONS                                           //
// ============================================================================================= //

@use "sass:map";
@use "@unsass/css/custom-properties";
@use "../variables";
@use "../functions";

$_custom-property-prefix: "color";

// ------------------------------------------------------------------------- //
// Private functions
// ------------------------------------------------------------------------- //

///
/// Check if color token exist.
///
@function _exist($token) {
    @if not map.has-key(variables.$colors, $token) {
        @error "Invalid color scheme, '#{$token}' doesn't exist. Choose one of #{map.keys(variables.$colors)}.";
    }

    @return map.has-key(variables.$colors, $token);
}

// ------------------------------------------------------------------------- //
// Public functions
// ------------------------------------------------------------------------- //

///
/// @example - scss
///   $color: color.tokens(); -> `("primary", "secondary")`
///
@function tokens() {
    @return map.keys(variables.$colors);
}

///
/// @example - scss
///   $color: get-tokens(); -> `("primary", "secondary")`
///
/// @deprecated Use `tokens()` function instead.
///
@function get-tokens() {
    @return tokens();
}

///
/// @example - scss
///   $color: color.value("primary"); -> `darkcyan`
///
@function value($token) {
    @if _exist($token) {
        @return map.get(variables.$colors, $token);
    }
}

///
/// @example - scss
///   $color: get-value("primary"); -> `darkcyan`
///
/// @deprecated Use `value()` function instead.
///
@function get-value($token) {
    @if _exist($token) {
        @return value($token);
    }
}

///
/// @example - scss
///   .foo {
///     color: color.variable("primary");
///   }
///
/// @example - css
///   .foo {
///     color: var(--mg-color-primary)
///   }
///
/// @return {String} The token value.
/// @return {Boolean} The fallback value.
///
@function variable($token, $fallback: false) {
    $name: functions.create-name(#{$_custom-property-prefix}-#{$token});

    @if $fallback {
        @return custom-properties.create-var(custom-properties.create($name, value($token)));
    }

    @return custom-properties.create-var(custom-properties.create($name));
}

///
/// @example - scss
///   $color: get-variable("primary"); -> `var(--mg-theme-primary, darkcyan)`
///
/// @example - scss
///   $color: get-variable("primary", "color"); -> `var(--mg-color-primary, darkcyan)`
///
/// @deprecated Use `variable()` function instead.
///
@function get-variable($token, $prefix: theme) {
    $name: functions.create-name(#{$prefix}-#{$token});
    $value: value($token);

    @return custom-properties.create-var(custom-properties.create($name, $value));
}
